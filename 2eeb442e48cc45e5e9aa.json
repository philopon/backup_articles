{"rendered_body": "\n<h1>\n<span id=\"\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\" class=\"fragment\"></span><a href=\"#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E8%87%AA%E7%84%B6%E6%95%B0\"><i class=\"fa fa-link\"></i></a>\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570</h1>\n\n<div class=\"code-frame\" data-lang=\"hs\"><div class=\"highlight\"><pre><span class=\"cp\">{-# LANGUAGE DataKinds #-}</span>\n\n<span class=\"kr\">import</span> <span class=\"nn\">Data.Proxy</span>\n\n<span class=\"n\">one</span> <span class=\"o\">::</span> <span class=\"kt\">Proxy</span> <span class=\"mi\">1</span> <span class=\"c1\">-- &lt;- \u3053\u308c!!!</span>\n<span class=\"n\">one</span> <span class=\"o\">=</span> <span class=\"kt\">Proxy</span>\n</pre></div></div>\n\n<h1>\n<span id=\"\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\" class=\"fragment\"></span><a href=\"#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E8%87%AA%E7%84%B6%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E9%95%B7%E3%81%95%E4%BB%98%E3%81%8D%E3%83%AA%E3%82%B9%E3%83%88\"><i class=\"fa fa-link\"></i></a>\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8</h1>\n\n<div class=\"code-frame\" data-lang=\"hs\"><div class=\"highlight\"><pre><span class=\"cp\">{-# LANGUAGE DataKinds, GADTs, TypeOperators, KindSignatures, StandaloneDeriving #-}</span>\n\n<span class=\"kr\">import</span> <span class=\"nn\">GHC.TypeLits</span>\n\n<span class=\"kr\">data</span> <span class=\"kt\">List</span> <span class=\"o\">::</span> <span class=\"kt\">Nat</span> <span class=\"o\">-&gt;</span> <span class=\"o\">*</span> <span class=\"o\">-&gt;</span> <span class=\"o\">*</span> <span class=\"kr\">where</span>\n    <span class=\"kt\">Nil</span>   <span class=\"o\">::</span> <span class=\"kt\">List</span> <span class=\"mi\">0</span> <span class=\"n\">a</span>\n    <span class=\"p\">(</span><span class=\"o\">:::</span><span class=\"p\">)</span> <span class=\"o\">::</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"n\">length</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"n\">length</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span>\n\n<span class=\"kr\">infixr</span> <span class=\"mi\">5</span> <span class=\"o\">:::</span>\n\n<span class=\"kr\">deriving</span> <span class=\"kr\">instance</span> <span class=\"kt\">Show</span> <span class=\"n\">a</span> <span class=\"o\">=&gt;</span> <span class=\"kt\">Show</span> <span class=\"p\">(</span><span class=\"kt\">List</span> <span class=\"n\">l</span> <span class=\"n\">a</span><span class=\"p\">)</span>\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"hs\">\n<div class=\"code-lang\"><span class=\"bold\">ghci</span></div>\n<div class=\"highlight\"><pre><span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"o\">:</span><span class=\"n\">load</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span>\n<span class=\"p\">[</span><span class=\"mi\">1</span> <span class=\"kr\">of</span> <span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"kt\">Compiling</span> <span class=\"kt\">Main</span>             <span class=\"p\">(</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"p\">,</span> <span class=\"n\">interpreted</span> <span class=\"p\">)</span>\n<span class=\"kt\">Ok</span><span class=\"p\">,</span> <span class=\"n\">modules</span> <span class=\"n\">loaded</span><span class=\"o\">:</span> <span class=\"kt\">Main</span><span class=\"o\">.</span>\n\n<span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"mi\">1</span> <span class=\"o\">:::</span> <span class=\"mi\">2</span> <span class=\"o\">:::</span> <span class=\"mi\">3</span> <span class=\"o\">:::</span> <span class=\"kt\">Nil</span>\n<span class=\"mi\">1</span> <span class=\"o\">:::</span> <span class=\"p\">(</span><span class=\"mi\">2</span> <span class=\"o\">:::</span> <span class=\"p\">(</span><span class=\"mi\">3</span> <span class=\"o\">:::</span> <span class=\"kt\">Nil</span><span class=\"p\">))</span>\n\n<span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"o\">:</span><span class=\"n\">t</span> <span class=\"mi\">1</span> <span class=\"o\">:::</span> <span class=\"mi\">2</span> <span class=\"o\">:::</span> <span class=\"mi\">3</span> <span class=\"o\">:::</span> <span class=\"kt\">Nil</span>\n<span class=\"mi\">1</span> <span class=\"o\">:::</span> <span class=\"mi\">2</span> <span class=\"o\">:::</span> <span class=\"mi\">3</span> <span class=\"o\">:::</span> <span class=\"kt\">Nil</span> <span class=\"o\">::</span> <span class=\"kt\">Num</span> <span class=\"n\">a</span> <span class=\"o\">=&gt;</span> <span class=\"kt\">List</span> <span class=\"mi\">3</span> <span class=\"n\">a</span>\n</pre></div>\n</div>\n\n<p><img alt=\":smiley:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f603.png\" title=\":smiley:\" width=\"20\" loading=\"lazy\"></p>\n\n<h2>\n<span id=\"\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\u3067head\" class=\"fragment\"></span><a href=\"#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E8%87%AA%E7%84%B6%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E9%95%B7%E3%81%95%E4%BB%98%E3%81%8D%E3%83%AA%E3%82%B9%E3%83%88%E3%81%A7head\"><i class=\"fa fa-link\"></i></a>\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\u3067head</h2>\n\n<div class=\"code-frame\" data-lang=\"hs\"><div class=\"highlight\"><pre><span class=\"n\">head_</span> <span class=\"o\">::</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"n\">n</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"n\">a</span>\n<span class=\"n\">head_</span> <span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"o\">:::</span> <span class=\"kr\">_</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">a</span>\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"hs\">\n<div class=\"code-lang\"><span class=\"bold\">ghci</span></div>\n<div class=\"highlight\"><pre><span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"o\">:</span><span class=\"n\">load</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span>\n<span class=\"p\">[</span><span class=\"mi\">1</span> <span class=\"kr\">of</span> <span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"kt\">Compiling</span> <span class=\"kt\">Main</span>             <span class=\"p\">(</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"p\">,</span> <span class=\"n\">interpreted</span> <span class=\"p\">)</span>\n<span class=\"kt\">Ok</span><span class=\"p\">,</span> <span class=\"n\">modules</span> <span class=\"n\">loaded</span><span class=\"o\">:</span> <span class=\"kt\">Main</span><span class=\"o\">.</span>\n\n<span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"n\">head_</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">:::</span> <span class=\"kt\">Nil</span><span class=\"p\">)</span>\n<span class=\"mi\">1</span>\n\n<span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"n\">head_</span> <span class=\"kt\">Nil</span> <span class=\"c1\">-- \u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u30a8\u30e9\u30fc</span>\n<span class=\"o\">&lt;</span><span class=\"n\">interactive</span><span class=\"o\">&gt;:</span><span class=\"mi\">3</span><span class=\"o\">:</span><span class=\"mi\">7</span><span class=\"o\">:</span>\n    <span class=\"kt\">Couldn't</span> <span class=\"n\">match</span> <span class=\"kr\">type</span> <span class=\"err\">\u2018</span><span class=\"mi\">1</span><span class=\"err\">\u2019</span> <span class=\"n\">with</span> <span class=\"err\">\u2018</span><span class=\"mi\">0</span><span class=\"err\">\u2019</span>\n    <span class=\"kt\">Expected</span> <span class=\"kr\">type</span><span class=\"o\">:</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"mi\">0</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span>\n      <span class=\"kt\">Actual</span> <span class=\"kr\">type</span><span class=\"o\">:</span> <span class=\"kt\">List</span> <span class=\"mi\">0</span> <span class=\"n\">a</span>\n    <span class=\"kt\">In</span> <span class=\"n\">the</span> <span class=\"n\">first</span> <span class=\"n\">argument</span> <span class=\"kr\">of</span> <span class=\"err\">\u2018</span><span class=\"n\">head_</span><span class=\"err\">\u2019</span><span class=\"p\">,</span> <span class=\"n\">namely</span> <span class=\"err\">\u2018</span><span class=\"kt\">Nil</span><span class=\"err\">\u2019</span>\n    <span class=\"kt\">In</span> <span class=\"n\">the</span> <span class=\"n\">expression</span><span class=\"o\">:</span> <span class=\"n\">head_</span> <span class=\"kt\">Nil</span>\n</pre></div>\n</div>\n\n<p><img alt=\":smile:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f604.png\" title=\":smile:\" width=\"20\" loading=\"lazy\"><sup id=\"fnref1\"><a href=\"#fn1\" rel=\"footnote\" title=\"\u305f\u3060\u3057\u3001head_ :: List n a -&gt; a\u3067\u3082\u666e\u901a\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u901a\u308a\u3001\u305d\u306e\u5834\u5408\u306fhead_ Nil\u306f\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u306b\u306a\u308b\u306e\u3067\u6ce8\u610f\">1</a></sup></p>\n\n<h2>\n<span id=\"\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\u3067tail\" class=\"fragment\"></span><a href=\"#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E8%87%AA%E7%84%B6%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E9%95%B7%E3%81%95%E4%BB%98%E3%81%8D%E3%83%AA%E3%82%B9%E3%83%88%E3%81%A7tail\"><i class=\"fa fa-link\"></i></a>\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\u3067tail</h2>\n\n<div class=\"code-frame\" data-lang=\"hs\"><div class=\"highlight\"><pre><span class=\"n\">tail_</span> <span class=\"o\">::</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"n\">n</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"n\">n</span> <span class=\"n\">a</span>\n<span class=\"n\">tail_</span> <span class=\"p\">(</span><span class=\"kr\">_</span> <span class=\"o\">:::</span> <span class=\"n\">as</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">as</span>\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"hs\">\n<div class=\"code-lang\"><span class=\"bold\">ghci</span></div>\n<div class=\"highlight\"><pre><span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"o\">:</span><span class=\"n\">load</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span>\n<span class=\"p\">[</span><span class=\"mi\">1</span> <span class=\"kr\">of</span> <span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"kt\">Compiling</span> <span class=\"kt\">Main</span>             <span class=\"p\">(</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"p\">,</span> <span class=\"n\">interpreted</span> <span class=\"p\">)</span>\n\n<span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"o\">:</span><span class=\"mi\">17</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span>\n    <span class=\"kt\">Could</span> <span class=\"n\">not</span> <span class=\"n\">deduce</span> <span class=\"p\">(</span><span class=\"n\">length</span> <span class=\"o\">~</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n    <span class=\"n\">from</span> <span class=\"n\">the</span> <span class=\"n\">context</span> <span class=\"p\">((</span><span class=\"n\">n</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"o\">~</span> <span class=\"p\">(</span><span class=\"n\">length</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n      <span class=\"n\">bound</span> <span class=\"n\">by</span> <span class=\"n\">a</span> <span class=\"n\">pattern</span> <span class=\"n\">with</span> <span class=\"n\">constructor</span>\n                 <span class=\"o\">:::</span> <span class=\"o\">::</span> <span class=\"n\">forall</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"n\">length</span> <span class=\"o\">::</span> <span class=\"kt\">Nat</span><span class=\"p\">)</span><span class=\"o\">.</span>\n                        <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"n\">length</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"n\">length</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span><span class=\"p\">,</span>\n               <span class=\"kr\">in</span> <span class=\"n\">an</span> <span class=\"n\">equation</span> <span class=\"n\">for</span> <span class=\"err\">\u2018</span><span class=\"n\">tail_</span><span class=\"err\">\u2019</span>\n      <span class=\"n\">at</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"o\">:</span><span class=\"mi\">17</span><span class=\"o\">:</span><span class=\"mi\">8</span><span class=\"o\">-</span><span class=\"mi\">15</span>\n      <span class=\"err\">\u2018</span><span class=\"n\">length</span><span class=\"err\">\u2019</span> <span class=\"n\">is</span> <span class=\"n\">a</span> <span class=\"n\">rigid</span> <span class=\"kr\">type</span> <span class=\"n\">variable</span> <span class=\"n\">bound</span> <span class=\"n\">by</span>\n               <span class=\"n\">a</span> <span class=\"n\">pattern</span> <span class=\"n\">with</span> <span class=\"n\">constructor</span>\n                 <span class=\"o\">:::</span> <span class=\"o\">::</span> <span class=\"n\">forall</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"n\">length</span> <span class=\"o\">::</span> <span class=\"kt\">Nat</span><span class=\"p\">)</span><span class=\"o\">.</span>\n                        <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"n\">length</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"n\">length</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span><span class=\"p\">,</span>\n               <span class=\"kr\">in</span> <span class=\"n\">an</span> <span class=\"n\">equation</span> <span class=\"n\">for</span> <span class=\"err\">\u2018</span><span class=\"n\">tail_</span><span class=\"err\">\u2019</span>\n               <span class=\"n\">at</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"o\">:</span><span class=\"mi\">17</span><span class=\"o\">:</span><span class=\"mi\">8</span>\n      <span class=\"err\">\u2018</span><span class=\"n\">n</span><span class=\"err\">\u2019</span> <span class=\"n\">is</span> <span class=\"n\">a</span> <span class=\"n\">rigid</span> <span class=\"kr\">type</span> <span class=\"n\">variable</span> <span class=\"n\">bound</span> <span class=\"n\">by</span>\n          <span class=\"n\">the</span> <span class=\"kr\">type</span> <span class=\"n\">signature</span> <span class=\"n\">for</span> <span class=\"n\">tail_</span> <span class=\"o\">::</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"n\">n</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"n\">n</span> <span class=\"n\">a</span>\n          <span class=\"n\">at</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"o\">:</span><span class=\"mi\">16</span><span class=\"o\">:</span><span class=\"mi\">10</span>\n    <span class=\"kt\">Expected</span> <span class=\"kr\">type</span><span class=\"o\">:</span> <span class=\"kt\">List</span> <span class=\"n\">n</span> <span class=\"n\">a</span>\n      <span class=\"kt\">Actual</span> <span class=\"kr\">type</span><span class=\"o\">:</span> <span class=\"kt\">List</span> <span class=\"n\">length</span> <span class=\"n\">a</span>\n    <span class=\"kt\">Relevant</span> <span class=\"n\">bindings</span> <span class=\"n\">include</span>\n      <span class=\"n\">as</span> <span class=\"o\">::</span> <span class=\"kt\">List</span> <span class=\"n\">length</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"n\">bound</span> <span class=\"n\">at</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"o\">:</span><span class=\"mi\">17</span><span class=\"o\">:</span><span class=\"mi\">14</span><span class=\"p\">)</span>\n      <span class=\"n\">tail_</span> <span class=\"o\">::</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"n\">n</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span> <span class=\"o\">-&gt;</span> <span class=\"kt\">List</span> <span class=\"n\">n</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"n\">bound</span> <span class=\"n\">at</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"o\">:</span><span class=\"mi\">17</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n    <span class=\"kt\">In</span> <span class=\"n\">the</span> <span class=\"n\">expression</span><span class=\"o\">:</span> <span class=\"n\">as</span>\n    <span class=\"kt\">In</span> <span class=\"n\">an</span> <span class=\"n\">equation</span> <span class=\"n\">for</span> <span class=\"err\">\u2018</span><span class=\"n\">tail_</span><span class=\"err\">\u2019</span><span class=\"o\">:</span> <span class=\"n\">tail_</span> <span class=\"p\">(</span><span class=\"kr\">_</span> <span class=\"o\">:::</span> <span class=\"n\">as</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">as</span>\n<span class=\"kt\">Failed</span><span class=\"p\">,</span> <span class=\"n\">modules</span> <span class=\"n\">loaded</span><span class=\"o\">:</span> <span class=\"n\">none</span><span class=\"o\">.</span>\n</pre></div>\n</div>\n\n<p><img alt=\":scream:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f631.png\" title=\":scream:\" width=\"20\" loading=\"lazy\">\u3088\u308f\u3044(\u78ba\u4fe1<sup id=\"fnref2\"><a href=\"#fn2\" rel=\"footnote\" title=\"n + 1\u304cn\u306e\u6b21\u306e\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30b3\u30f3\u30d1\u30a4\u30e9\u306f\u308f\u304b\u3089\u306a\u304f\u3066\u6b7b\u306c\">2</a></sup></p>\n\n<h1>\n<span id=\"\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3064\u3088\u3044\" class=\"fragment\"></span><a href=\"#%E5%9E%8B%E3%83%AC%E3%83%99%E3%83%AB%E8%87%AA%E7%84%B6%E6%95%B0%E3%81%A4%E3%82%88%E3%81%84\"><i class=\"fa fa-link\"></i></a>\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570(\u3064\u3088\u3044)</h1>\n\n<p>\u4ee5\u4e0b\u306e1\u884c\u3092\u30d5\u30a1\u30a4\u30eb\u306e\u5148\u982d<sup id=\"fnref3\"><a href=\"#fn3\" rel=\"footnote\" title=\"\u30d5\u30a1\u30a4\u30eb\u30d8\u30c3\u30c0\u30d7\u30e9\u30b0\u30de\u306a\u306e\u3067\u5b9f\u969b\u306b\u306fmodule Hoge where\u306e\u524d\u306a\u3089\u3069\u3053\u3067\u3082ok\u3002\">3</a></sup>\u306b\u8ffd\u52a0</p>\n\n<div class=\"code-frame\" data-lang=\"hs\"><div class=\"highlight\"><pre><span class=\"cp\">{-# OPTIONS_GHC -fplugin=GHC.TypeLits.Normalise #-}</span>\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"console\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>stack <span class=\"nb\">install </span>ghc-typelits-natnormalise\n<span class=\"gp\">$</span><span class=\"w\"> </span>stack ghci <span class=\"nt\">--package</span><span class=\"o\">=</span>ghc-typelits-natnormalise\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"hs\">\n<div class=\"code-lang\"><span class=\"bold\">ghci</span></div>\n<div class=\"highlight\"><pre><span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"o\">:</span><span class=\"n\">load</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span>\n<span class=\"p\">[</span><span class=\"mi\">1</span> <span class=\"kr\">of</span> <span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"kt\">Compiling</span> <span class=\"kt\">Main</span>             <span class=\"p\">(</span> <span class=\"n\">foo</span><span class=\"o\">.</span><span class=\"n\">hs</span><span class=\"p\">,</span> <span class=\"n\">interpreted</span> <span class=\"p\">)</span>\n<span class=\"kt\">Ok</span><span class=\"p\">,</span> <span class=\"n\">modules</span> <span class=\"n\">loaded</span><span class=\"o\">:</span> <span class=\"kt\">Main</span><span class=\"o\">.</span>\n</pre></div>\n</div>\n\n<p><img alt=\":flushed:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f633.png\" title=\":flushed:\" width=\"20\" loading=\"lazy\"></p>\n\n<div class=\"code-frame\" data-lang=\"hs\">\n<div class=\"code-lang\"><span class=\"bold\">ghci</span></div>\n<div class=\"highlight\"><pre><span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"n\">tail_</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">:::</span> <span class=\"mi\">2</span> <span class=\"o\">:::</span> <span class=\"mi\">3</span> <span class=\"o\">:::</span> <span class=\"kt\">Nil</span><span class=\"p\">)</span>\n<span class=\"mi\">2</span> <span class=\"o\">:::</span> <span class=\"p\">(</span><span class=\"mi\">3</span> <span class=\"o\">:::</span> <span class=\"kt\">Nil</span><span class=\"p\">)</span>\n\n<span class=\"err\">\u03bb</span><span class=\"o\">&gt;</span> <span class=\"n\">tail_</span> <span class=\"kt\">Nil</span> <span class=\"c1\">-- \u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u30a8\u30e9\u30fc</span>\n\n<span class=\"o\">&lt;</span><span class=\"n\">interactive</span><span class=\"o\">&gt;:</span><span class=\"mi\">4</span><span class=\"o\">:</span><span class=\"mi\">7</span><span class=\"o\">:</span>\n    <span class=\"kt\">Couldn't</span> <span class=\"n\">match</span> <span class=\"kr\">type</span> <span class=\"err\">\u2018</span><span class=\"mi\">1</span><span class=\"err\">\u2019</span> <span class=\"n\">with</span> <span class=\"err\">\u2018</span><span class=\"mi\">0</span><span class=\"err\">\u2019</span>\n    <span class=\"kt\">Expected</span> <span class=\"kr\">type</span><span class=\"o\">:</span> <span class=\"kt\">List</span> <span class=\"p\">(</span><span class=\"mi\">0</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"n\">a</span>\n      <span class=\"kt\">Actual</span> <span class=\"kr\">type</span><span class=\"o\">:</span> <span class=\"kt\">List</span> <span class=\"mi\">0</span> <span class=\"n\">a</span>\n    <span class=\"kt\">In</span> <span class=\"n\">the</span> <span class=\"n\">first</span> <span class=\"n\">argument</span> <span class=\"kr\">of</span> <span class=\"err\">\u2018</span><span class=\"n\">tail_</span><span class=\"err\">\u2019</span><span class=\"p\">,</span> <span class=\"n\">namely</span> <span class=\"err\">\u2018</span><span class=\"kt\">Nil</span><span class=\"err\">\u2019</span>\n    <span class=\"kt\">In</span> <span class=\"n\">the</span> <span class=\"n\">expression</span><span class=\"o\">:</span> <span class=\"n\">tail_</span> <span class=\"kt\">Nil</span>\n</pre></div>\n</div>\n\n<p>\u3064\u3088\u3044<img alt=\":clap:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f44f.png\" title=\":clap:\" width=\"20\" loading=\"lazy\"><img alt=\":clap:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f44f.png\" title=\":clap:\" width=\"20\" loading=\"lazy\"><img alt=\":clap:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f44f.png\" title=\":clap:\" width=\"20\" loading=\"lazy\"></p>\n\n<h2>\n<span id=\"\u306a\u305c\" class=\"fragment\"></span><a href=\"#%E3%81%AA%E3%81%9C\"><i class=\"fa fa-link\"></i></a>\u306a\u305c</h2>\n\n<p>ghc-plugin\u3092\u4f7f\u3048\u3070\u3001ghc\u672c\u4f53\u3092\u5f04\u308b\u4e8b\u306a\u304f\u6700\u9069\u5316\u3084\u578b\u30c1\u30a7\u30c3\u30af\u3092\u62e1\u5f35\u3067\u304d\u308b</p>\n\n<p><a href=\"https://hackage.haskell.org/package/ghc-typelits-natnormalise\" rel=\"nofollow noopener\" target=\"_blank\">ghc-typelits-natnormalise</a> \u30d1\u30c3\u30b1\u30fc\u30b8\u306eghc-plugin\u306b\u3088\u308a\u3001\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u304c\u7b49\u3057\u3044\u304b\u3069\u3046\u304b\u306e\u78ba\u8a8d\u304c\u51fa\u6765\u308b\u69d8\u306b\u306a\u308b<sup id=\"fnref4\"><a href=\"#fn4\" rel=\"footnote\" title=\"\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092sort-of SOP (Sum-of-Products) form\u306b\u5909\u63db\u3057\u3066\u30c1\u30a7\u30c3\u30af\u3057\u3066\u308b\u3068\u304b\u306a\u3093\u3068\u304b\">4</a></sup></p>\n\n<p>\u3059\u3054\u3044<img alt=\":clap:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f44f.png\" title=\":clap:\" width=\"20\" loading=\"lazy\"><img alt=\":clap:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f44f.png\" title=\":clap:\" width=\"20\" loading=\"lazy\"><img alt=\":clap:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f44f.png\" title=\":clap:\" width=\"20\" loading=\"lazy\"></p>\n\n<h1>\n<span id=\"\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\" class=\"fragment\"></span><a href=\"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%B3%E3%83%BC%E3%83%89\"><i class=\"fa fa-link\"></i></a>\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9</h1>\n\n<p>\u3082\u3046\u5c11\u3057\u30ea\u30b9\u30c8\u306e\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u578b\u5408\u305b\u30b2\u30fc\u30e0\u3092\u30af\u30ea\u30a2\u3057\u305f\u30b3\u30fc\u30c9 \u2192 <a href=\"https://gist.github.com/philopon/a3ff274b371b8c75033a\" rel=\"nofollow noopener\" target=\"_blank\">foo.hs</a></p>\n\n<h1>\n<span id=\"\u307e\u3068\u3081\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>\u307e\u3068\u3081</h1>\n\n<ul>\n<li>\u306d\u3080\u3044</li>\n<li>ghc-plugin\u3057\u3085\u3054\u3044\u306e\u3049\u3049\u3049\u3049\u3049</li>\n</ul>\n\n<hr>\n\n<div class=\"footnotes\">\n<hr>\n<ol>\n\n<li id=\"fn1\">\n<p>\u305f\u3060\u3057\u3001<code>head_ :: List n a -&gt; a</code>\u3067\u3082\u666e\u901a\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u901a\u308a\u3001\u305d\u306e\u5834\u5408\u306f<code>head_ Nil</code>\u306f\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u306b\u306a\u308b\u306e\u3067\u6ce8\u610f\u00a0<a href=\"#fnref1\">\u21a9</a></p>\n</li>\n\n<li id=\"fn2\">\n<p><code>n + 1</code>\u304c<code>n</code>\u306e\u6b21\u306e\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30b3\u30f3\u30d1\u30a4\u30e9\u306f\u308f\u304b\u3089\u306a\u304f\u3066\u6b7b\u306c\u00a0<a href=\"#fnref2\">\u21a9</a></p>\n</li>\n\n<li id=\"fn3\">\n<p>\u30d5\u30a1\u30a4\u30eb\u30d8\u30c3\u30c0\u30d7\u30e9\u30b0\u30de\u306a\u306e\u3067\u5b9f\u969b\u306b\u306f<code>module Hoge where</code>\u306e\u524d\u306a\u3089\u3069\u3053\u3067\u3082ok\u3002\u00a0<a href=\"#fnref3\">\u21a9</a></p>\n</li>\n\n<li id=\"fn4\">\n<p>\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092sort-of SOP (Sum-of-Products) form\u306b\u5909\u63db\u3057\u3066\u30c1\u30a7\u30c3\u30af\u3057\u3066\u308b\u3068\u304b\u306a\u3093\u3068\u304b\u00a0<a href=\"#fnref4\">\u21a9</a></p>\n</li>\n\n</ol>\n</div>\n", "body": "\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\n==\n```.hs\n{-# LANGUAGE DataKinds #-}\n\nimport Data.Proxy\n\none :: Proxy 1 -- <- \u3053\u308c!!!\none = Proxy\n```\n\n\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\n==\n```.hs\n{-# LANGUAGE DataKinds, GADTs, TypeOperators, KindSignatures, StandaloneDeriving #-}\n\nimport GHC.TypeLits\n\ndata List :: Nat -> * -> * where\n    Nil   :: List 0 a\n    (:::) :: a -> List length a -> List (length + 1) a\n\ninfixr 5 :::\n\nderiving instance Show a => Show (List l a)\n```\n\n```.hs:ghci\n\u03bb> :load foo.hs\n[1 of 1] Compiling Main             ( foo.hs, interpreted )\nOk, modules loaded: Main.\n\n\u03bb> 1 ::: 2 ::: 3 ::: Nil\n1 ::: (2 ::: (3 ::: Nil))\n\n\u03bb> :t 1 ::: 2 ::: 3 ::: Nil\n1 ::: 2 ::: 3 ::: Nil :: Num a => List 3 a\n```\n\n:smiley:\n\n\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\u3067head\n--\n```.hs\nhead_ :: List (n + 1) a -> a\nhead_ (a ::: _) = a\n```\n\n```.hs:ghci\n\u03bb> :load foo.hs\n[1 of 1] Compiling Main             ( foo.hs, interpreted )\nOk, modules loaded: Main.\n\n\u03bb> head_ (1 ::: Nil)\n1\n\n\u03bb> head_ Nil -- \u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u30a8\u30e9\u30fc\n<interactive>:3:7:\n    Couldn't match type \u20181\u2019 with \u20180\u2019\n    Expected type: List (0 + 1) a\n      Actual type: List 0 a\n    In the first argument of \u2018head_\u2019, namely \u2018Nil\u2019\n    In the expression: head_ Nil\n```\n\n:smile:[^head_]\n\n\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092\u4f7f\u3063\u305f\u9577\u3055\u4ed8\u304d\u30ea\u30b9\u30c8\u3067tail\n--\n```.hs\ntail_ :: List (n + 1) a -> List n a\ntail_ (_ ::: as) = as\n```\n\n```.hs:ghci\n\u03bb> :load foo.hs\n[1 of 1] Compiling Main             ( foo.hs, interpreted )\n\na.hs:17:20:\n    Could not deduce (length ~ n)\n    from the context ((n + 1) ~ (length + 1))\n      bound by a pattern with constructor\n                 ::: :: forall a (length :: Nat).\n                        a -> List length a -> List (length + 1) a,\n               in an equation for \u2018tail_\u2019\n      at a.hs:17:8-15\n      \u2018length\u2019 is a rigid type variable bound by\n               a pattern with constructor\n                 ::: :: forall a (length :: Nat).\n                        a -> List length a -> List (length + 1) a,\n               in an equation for \u2018tail_\u2019\n               at a.hs:17:8\n      \u2018n\u2019 is a rigid type variable bound by\n          the type signature for tail_ :: List (n + 1) a -> List n a\n          at a.hs:16:10\n    Expected type: List n a\n      Actual type: List length a\n    Relevant bindings include\n      as :: List length a (bound at a.hs:17:14)\n      tail_ :: List (n + 1) a -> List n a (bound at a.hs:17:1)\n    In the expression: as\n    In an equation for \u2018tail_\u2019: tail_ (_ ::: as) = as\nFailed, modules loaded: none.\n```\n\n:scream:\u3088\u308f\u3044(\u78ba\u4fe1[^tail_]\n\n\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570(\u3064\u3088\u3044)\n==\n\n\u4ee5\u4e0b\u306e1\u884c\u3092\u30d5\u30a1\u30a4\u30eb\u306e\u5148\u982d[^header]\u306b\u8ffd\u52a0\n\n```.hs\n{-# OPTIONS_GHC -fplugin=GHC.TypeLits.Normalise #-}\n```\n\n```console:\n$ stack install ghc-typelits-natnormalise\n$ stack ghci --package=ghc-typelits-natnormalise\n```\n\n```.hs:ghci\n\u03bb> :load foo.hs\n[1 of 1] Compiling Main             ( foo.hs, interpreted )\nOk, modules loaded: Main.\n```\n\n:flushed:\n\n```.hs:ghci\n\u03bb> tail_ (1 ::: 2 ::: 3 ::: Nil)\n2 ::: (3 ::: Nil)\n\n\u03bb> tail_ Nil -- \u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u30a8\u30e9\u30fc\n\n<interactive>:4:7:\n    Couldn't match type \u20181\u2019 with \u20180\u2019\n    Expected type: List (0 + 1) a\n      Actual type: List 0 a\n    In the first argument of \u2018tail_\u2019, namely \u2018Nil\u2019\n    In the expression: tail_ Nil\n```\n\n\u3064\u3088\u3044:clap::clap::clap:\n\n\u306a\u305c\n--\nghc-plugin\u3092\u4f7f\u3048\u3070\u3001ghc\u672c\u4f53\u3092\u5f04\u308b\u4e8b\u306a\u304f\u6700\u9069\u5316\u3084\u578b\u30c1\u30a7\u30c3\u30af\u3092\u62e1\u5f35\u3067\u304d\u308b\n\n[ghc-typelits-natnormalise](https://hackage.haskell.org/package/ghc-typelits-natnormalise) \u30d1\u30c3\u30b1\u30fc\u30b8\u306eghc-plugin\u306b\u3088\u308a\u3001\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u304c\u7b49\u3057\u3044\u304b\u3069\u3046\u304b\u306e\u78ba\u8a8d\u304c\u51fa\u6765\u308b\u69d8\u306b\u306a\u308b[^sop]\n\n\u3059\u3054\u3044:clap::clap::clap:\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n==\n\u3082\u3046\u5c11\u3057\u30ea\u30b9\u30c8\u306e\u95a2\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u578b\u5408\u305b\u30b2\u30fc\u30e0\u3092\u30af\u30ea\u30a2\u3057\u305f\u30b3\u30fc\u30c9 \u2192 [foo.hs](https://gist.github.com/philopon/a3ff274b371b8c75033a)\n\n\u307e\u3068\u3081\n==\n* \u306d\u3080\u3044\n* ghc-plugin\u3057\u3085\u3054\u3044\u306e\u3049\u3049\u3049\u3049\u3049\n\n------\n[^head_]: \u305f\u3060\u3057\u3001`head_ :: List n a -> a`\u3067\u3082\u666e\u901a\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u901a\u308a\u3001\u305d\u306e\u5834\u5408\u306f`head_ Nil`\u306f\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u306b\u306a\u308b\u306e\u3067\u6ce8\u610f\n[^tail_]: `n + 1`\u304c`n`\u306e\u6b21\u306e\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30b3\u30f3\u30d1\u30a4\u30e9\u306f\u308f\u304b\u3089\u306a\u304f\u3066\u6b7b\u306c\n[^header]: \u30d5\u30a1\u30a4\u30eb\u30d8\u30c3\u30c0\u30d7\u30e9\u30b0\u30de\u306a\u306e\u3067\u5b9f\u969b\u306b\u306f`module Hoge where`\u306e\u524d\u306a\u3089\u3069\u3053\u3067\u3082ok\u3002\n[^sop]: \u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570\u3092sort-of SOP (Sum-of-Products) form\u306b\u5909\u63db\u3057\u3066\u30c1\u30a7\u30c3\u30af\u3057\u3066\u308b\u3068\u304b\u306a\u3093\u3068\u304b\n", "coediting": false, "comments_count": 0, "created_at": "2015-12-26T05:34:21+09:00", "group": null, "id": "2eeb442e48cc45e5e9aa", "likes_count": 12, "private": false, "reactions_count": 0, "tags": [{"name": "Haskell", "versions": []}, {"name": "ghc", "versions": ["7.10.2"]}, {"name": "ghc-typelits-natnormalise", "versions": ["0.3.1"]}], "title": "\u578b\u30ec\u30d9\u30eb\u81ea\u7136\u6570(\u3064\u3088\u3044)", "updated_at": "2015-12-26T18:29:04+09:00", "url": "https://qiita.com/philopon/items/2eeb442e48cc45e5e9aa", "user": {"description": "", "facebook_id": "", "followees_count": 4, "followers_count": 48, "github_login_name": null, "id": "philopon", "items_count": 30, "linkedin_id": "", "location": "", "name": "", "organization": "", "permanent_id": 33562, "profile_image_url": "https://qiita-image-store.s3.amazonaws.com/0/33562/profile-images/1473686152", "team_only": false, "twitter_screen_name": null, "website_url": "http://philopon.github.io"}, "page_views_count": null}